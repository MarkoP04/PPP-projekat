unit Anketa_u;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.Classes, System.Variants,
  FMX.Types, FMX.Controls, FMX.Forms, FMX.Graphics, FMX.Dialogs, FMX.StdCtrls,
  FMX.Controls.Presentation, FireDAC.Stan.Param;

type
  TForm4 = class(TForm)
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    RadioButton1: TRadioButton;
    RadioButton2: TRadioButton;
    RadioButton3: TRadioButton;
    RadioButton4: TRadioButton;
    RadioButton5: TRadioButton;
    Button1: TButton;
    Button2: TButton;
    RadioButton6: TRadioButton;
    RadioButton7: TRadioButton;
    RadioButton8: TRadioButton;
    RadioButton9: TRadioButton;
    RadioButton10: TRadioButton;
    RadioButton11: TRadioButton;
    RadioButton12: TRadioButton;
    RadioButton13: TRadioButton;
    RadioButton14: TRadioButton;
    RadioButton15: TRadioButton;
    RadioButton16: TRadioButton;
    RadioButton17: TRadioButton;
    RadioButton18: TRadioButton;
    RadioButton19: TRadioButton;
    RadioButton20: TRadioButton;
    RadioButton21: TRadioButton;
    RadioButton22: TRadioButton;
    RadioButton23: TRadioButton;
    RadioButton24: TRadioButton;
    RadioButton25: TRadioButton;
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form4: TForm4;

implementation

{$R *.fmx}

uses
Program_u, Testiranje_u;

procedure TForm4.Button1Click(Sender: TObject);
begin
  Form4.Free;
end;

procedure TForm4.Button2Click(Sender: TObject);
var
  RowValues: array[1..5] of Integer;
  i, j, idx: Integer;
  rb: TRadioButton;
  testID: Integer;
begin

  testID := Form3.SelectedTestID;


  for i := 1 to 5 do
  begin
    RowValues[i] := 1;
    for j := 1 to 5 do
    begin
      idx := i * 5 + j;
      rb := FindComponent('RadioButton' + IntToStr(idx)) as TRadioButton;
      if Assigned(rb) and rb.IsChecked then
      begin
        RowValues[i] := j;
        Break;
      end;
    end;
  end;

  // Now RowValues[0] = kiselost, RowValues[1] = slatkoca, etc.

  with Form1.FDQueryAction do
  begin
    Close;
    SQL.Text := 'INSERT INTO Ocena (test_id, kiselost, slatkoca, jacina, osvezavajuce, ukupno) ' +
                'VALUES (:test_id, :kiselost, :slatkoca, :jacina, :osvezavajuce, :ukupno)';
    ParamByName('test_id').AsInteger := testID;
    ParamByName('kiselost').AsInteger := RowValues[1];
    ParamByName('slatkoca').AsInteger := RowValues[2];
    ParamByName('jacina').AsInteger := RowValues[3];
    ParamByName('osvezavajuce').AsInteger := RowValues[4];
    ParamByName('ukupno').AsInteger := RowValues[5];
    ExecSQL;
  end;

  ShowMessage('Ocena je uspesno sacuvana.');
  Form4.Free;
end;


end.
